var AjaxLoader=function(){function n(){}return n.prototype.InitAjaxLoads=function(){for(var t=document.getElementsByClassName("ajax-load-html"),n=0;n<t.length;n++)this.LoadInnerHtmlToElement(t[n],null)},n.prototype.LoadInnerHtmlToElement=function(n,t){var r=$(n).data("ajax-link"),i=$(n).data("ajax-method"),f=$(n).data("request-data"),u=$(n).data("on-finish-script");i==null&&(i="GET");$.ajax({type:i,url:r,cache:!1,data:f,success:function(i){$(n).html(i);$(n).removeClass("ajax-load-html");u&&eval(u);t&&t()},error:function(n){alert("There is an execption while executing request "+r);console.log(n)}})},n}(),Logger_Resx=function(){function n(){this.LoggingAttempFailed="Произошла ошибка в логгировании ошибки, срочно обратитесь к разработчикам приложения";this.ErrorOnApiRequest="Ошибка запроса к апи";this.ActionLogged="Action logged";this.ExceptionLogged="Исключение залоггировано";this.ErrorOccuredOnLoggingException="Произошла ошибка в логгировании ошибки, срочно обратитесь к разработчикам приложения"}return n}(),Logger=function(){function n(){}return n.prototype.LogException=function(t,i,r){$.ajax({type:"POST",data:{ExceptionDate:(new Date).toISOString(),Description:i,Message:t,Uri:r!==null?r:location.href},url:"/Api/Log/Exception",async:!0,cache:!1,success:function(t){console.log(n.Resources.ExceptionLogged,t)},error:function(){alert(n.Resources.ErrorOccuredOnLoggingException)}})},n.prototype.LogAction=function(t,i,r){var u={LogDate:(new Date).toISOString(),GroupName:r,Uri:window.location.href,Description:i,Message:t};console.log("Logger.LogAction",u);$.ajax({type:"POST",data:u,url:"/Api/Log/Action",async:!0,cache:!1,success:function(t){console.log(n.Resources.ActionLogged,t)},error:function(){alert(n.Resources.LoggingAttempFailed)}})},n.Resources=new Logger_Resx,n}(),ModalWorker=function(){function n(){}return n.prototype.ShowModal=function(t){(t===""||t==null||t==undefined)&&(t=n.LoadingModal);$("#"+t).modal("show")},n.prototype.ShowLoadingModal=function(){this.ShowModal(n.LoadingModal)},n.prototype.HideModals=function(){$(".modal").modal("hide");$(".modal-backdrop.fade").remove();$(".modal").on("shown.bs.modal",function(){})},n.prototype.HideModal=function(n){$("#"+n).modal("hide")},n.LoadingModal="loadingModal",n}(),Requester_Resx=function(){function n(){this.YouPassedAnEmtpyArrayOfObjects="Вы подали пустой объект в запрос";this.ErrorOccuredWeKnowAboutIt="Произошла ошибка! Мы уже знаем о ней, и скоро с ней разберемся!";this.FilesNotSelected="Файлы не выбраны"}return n}(),Requester=function(){function n(){}return n.prototype.DeleteCompletedRequest=function(t){n.GoingRequests=n.GoingRequests.filter(function(n){return n!==t})},n.prototype.ParseDate=function(n){n=n.replace(new RegExp("/","g"),".");var t=n.split("."),i=new Date(+t[2],+t[1]-1,+t[0]);return i.toISOString()},n.prototype.GetCombinedData=function(n,t){var r={},i,u,f;for(i in t)if(Array.isArray(t[i]))r[n+i]=t[i];else if(typeof t[i]=="object"){u=this.GetCombinedData(""+n+i+".",t[i]);for(f in u)r[f]=u[f]}else r[n+i]=t[i];return r},n.prototype.GetParams=function(n){return n=this.GetCombinedData("",n),$.param(n,!0)},n.prototype.SendPostRequestWithAnimation=function(n,t,i,r){CrocoAppCore.ModalWorker.ShowLoadingModal();this.SendAjaxPost(n,t,i,r,!0)},n.prototype.UploadFilesToServer=function(t,i,r){var u="/Api/FilesDirectory/UploadFiles",f,o,e;if(!this.IsRequestGoing(u)){if(f=$("#"+t).prop("files"),o=new FormData,f.length===0){CrocoAppCore.ToastrWorker.ShowError(n.Resources.FilesNotSelected);r&&r();return}for(e=0;e<f.length;e++)o.append("Files",f[e]);$.ajax({url:u,type:"POST",data:o,async:!0,cache:!1,dataType:"json",contentType:!1,processData:!1,success:function(n){CrocoAppCore.Requester.DeleteCompletedRequest(u);i&&i(n)},error:function(t,i,f){CrocoAppCore.Logger.LogException(i.toString(),"ErrorOnApiRequest",u);CrocoAppCore.Requester.DeleteCompletedRequest(u);CrocoAppCore.ModalWorker.HideModals();CrocoAppCore.ToastrWorker.ShowError(n.Resources.ErrorOccuredWeKnowAboutIt);r&&r(t,i,f)}})}},n.prototype.IsRequestGoing=function(t){var i=n.GoingRequests.indexOf(t);return i>=0},n.OnSuccessAnimationHandler=function(n){CrocoAppCore.ModalWorker.HideModals();CrocoAppCore.ToastrWorker.HandleBaseApiResponse(n)},n.OnErrorAnimationHandler=function(){CrocoAppCore.ModalWorker.HideModals();CrocoAppCore.ToastrWorker.ShowError(n.Resources.ErrorOccuredWeKnowAboutIt)},n.prototype.SendAjaxGet=function(n,t,i,r){var f=this,u;this.IsRequestGoing(n)||(u={type:"GET",data:t,url:n,async:!0,cache:!1,success:function(t){f.DeleteCompletedRequest(n);i&&i(t)}.bind(this),error:function(t,i,u){CrocoAppCore.Logger.LogException(i.toString(),"Error on Api Request",n);CrocoAppCore.Requester.DeleteCompletedRequest(n);r&&r(t,i,u)}},$.ajax(u))},n.prototype.SendAjaxPost=function(t,i,r,u,f){var e,o;if(!this.IsRequestGoing(t)){if(i==null){alert(n.Resources.YouPassedAnEmtpyArrayOfObjects);return}e={};e.type="POST";e.data=i;e.url=t;e.async=!0;e.cache=!1;e.success=function(i){CrocoAppCore.Requester.DeleteCompletedRequest(t);f&&n.OnSuccessAnimationHandler(i);r&&r(i)};e.error=function(i,r,e){CrocoAppCore.Logger.LogException(r.toString(),"Error on Api Request",t);CrocoAppCore.Requester.DeleteCompletedRequest(t);f&&n.OnErrorAnimationHandler();u&&u(i,r,e)};o=i.constructor===Array;o&&(e.contentType="application/json; charset=utf-8",e.dataType="json",e.data=JSON.stringify(i));n.GoingRequests.push(t);$.ajax(e)}},n.Resources=new Requester_Resx,n.GoingRequests=[],n}(),ToastrWorker=function(){function n(){}return n.prototype.ShowError=function(n){var t={IsSucceeded:!1,Message:n};this.HandleBaseApiResponse(t)},n.prototype.ShowSuccess=function(n){var t={IsSucceeded:!0,Message:n};this.HandleBaseApiResponse(t)},n.prototype.HandleBaseApiResponse=function(n){if(n.IsSucceeded===undefined){alert("Произошла ошибка. Объект не является типом BaseApiResponse");return}if(n.Message===undefined){alert("Произошла ошибка. Объект не является типом BaseApiResponse");return}toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};n.IsSucceeded?toastr.success(n.Message):toastr.error(n.Message)},n}();